import streamlit as st
import folium
from streamlit_folium import st_folium

# --- í˜ì´ì§€ ê¸°ë³¸ ì„¤ì • ---
# ì•±ì˜ ì œëª©, ë ˆì´ì•„ì›ƒ, ì‚¬ì´ë“œë°” ìƒíƒœ ë“±ì„ ì„¤ì •í•´ì¤˜!
st.set_page_config(page_title="ë‚˜ë§Œì˜ ë¶ë§ˆí¬ ì§€ë„", layout="wide", initial_sidebar_state="expanded")

# --- ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™” í•¨ìˆ˜ ---
# ì•±ì´ ìƒˆë¡œê³ ì¹¨ë˜ì–´ë„ ë¶ë§ˆí¬ ëª©ë¡ì´ ì‚¬ë¼ì§€ì§€ ì•Šë„ë¡ st.session_stateì— ì €ì¥í•  ê±°ì•¼.
# 'bookmarks'ë¼ëŠ” ë¦¬ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ìƒˆë¡œ ë§Œë“¤ê³ , ì˜ˆì‹œ ë¶ë§ˆí¬ ëª‡ ê°œë¥¼ ì¶”ê°€í•´ë‘¬!
def init_session_state():
    if 'bookmarks' not in st.session_state:
        st.session_state.bookmarks = [
            # ê´‘ì£¼ê´‘ì—­ì‹œêµìœ¡ì—°êµ¬ì •ë³´ì› ë¶ë§ˆí¬ ì¶”ê°€
            {"name": "ê´‘ì£¼ê´‘ì—­ì‹œêµìœ¡ì—°êµ¬ì •ë³´ì›", 
             "latitude": 35.1559, # ëŒ€ëµì ì¸ ìœ„ë„
             "longitude": 126.8526, # ëŒ€ëµì ì¸ ê²½ë„
             "description": "ê³µê³µí•™ìŠµê´€ë¦¬ì‹œìŠ¤í…œ(LMS) ìš´ì˜, AI êµìœ¡ì› ì„¤ë¦½ ì¶”ì§„ ë“± ë¯¸ë˜ êµìœ¡ì„ ì„ ë„í•˜ëŠ” ê¸°ê´€ì´ì—ìš”! ğŸš€"},
            {"name": "ë‚¨ì‚°íƒ€ì›Œ", "latitude": 37.5512, "longitude": 126.9882, "description": "ì„œìš¸ì˜ ëœë“œë§ˆí¬! ê²½ì¹˜ ìµœê³ ì˜ˆìš”! ğŸ—¼"},
            {"name": "ê²½ë³µê¶", "latitude": 37.5796, "longitude": 126.9770, "description": "ì¡°ì„  ì‹œëŒ€ ì™•ê¶, í•œë³µ ì…ê³  êµ¬ê²½í•˜ë©´ ë” ì¢‹ì•„ìš”. ğŸ‘‘"},
            {"name": "í•´ìš´ëŒ€ í•´ìˆ˜ìš•ì¥", "latitude": 35.1587, "longitude": 129.1601, "description": "ë¶€ì‚°ì˜ ëŒ€í‘œ í•´ë³€, ì—¬ë¦„ì— ì‹œì›í•œ ë°”ë‹·ë°”ëŒ! ğŸ–ï¸"}
        ]
init_session_state()

st.title("ğŸ—ºï¸ ë‚˜ë§Œì˜ ì¦ê²¨ì°¾ê¸° ì§€ë„")
st.markdown("ê°€ê³  ì‹¶ì€ ê³³, ì¶”ì–µì˜ ì¥ì†Œë¥¼ ë‚˜ë§Œì˜ ì§€ë„ì— ì½•! ì €ì¥í•´ë³´ì„¸ìš”. ğŸ˜Š")

# ê´‘ì£¼ê´‘ì—­ì‹œêµìœ¡ì—°êµ¬ì •ë³´ì›ì— ëŒ€í•œ ì¶”ê°€ ì •ë³´ í‘œì‹œ
st.info(
    "ğŸ’¡ í˜¹ì‹œ ê´‘ì£¼ê´‘ì—­ì‹œêµìœ¡ì—°êµ¬ì •ë³´ì›ì— ëŒ€í•´ ì•„ì„¸ìš”? "
    "ì—¬ê¸°ëŠ” ê³µê³µí•™ìŠµê´€ë¦¬ì‹œìŠ¤í…œ(LMS) ìš´ì˜, ë””ì§€í„¸ êµìˆ˜Â·í•™ìŠµ í”Œë«í¼ êµ¬ì¶•, "
    "AI êµìœ¡ì› ì„¤ë¦½ ì¶”ì§„ ë“± ë¯¸ë˜ êµìœ¡ì„ ìœ„í•´ ì •ë§ í˜ì“°ëŠ” ê³³ì´ëë‹ˆë‹¤! [ã€1ã€‘](https://geris.gen.go.kr/), [ã€9ã€‘](https://sites.google.com/gsuite.gen.go.kr/2021gwangjuai/%ED%99%88) "
    "ìµœê·¼ì—ëŠ” ì¤‘ë“± ì˜ì¬ìº í”„ë„ ìš´ì˜í•˜ê³  ì „êµ­ ìµœì´ˆë¡œ êµìœ¡í–‰ì •ë°ì´í„°ë¥¼ ì—°ë™í•˜ê¸°ë„ í–ˆì–´ìš”. [ã€2ã€‘](http://www.newsworker.co.kr/news/articleView.html?idxno=387759), [ã€4ã€‘](https://www.yna.co.kr/view/AKR20250527072900054)"
)
st.markdown("---")


# --- 1. ë¶ë§ˆí¬ ì¶”ê°€í•˜ê¸° ì„¹ì…˜ ---
st.header("ğŸ“ ìƒˆë¡œìš´ ë¶ë§ˆí¬ ì¶”ê°€")

# st.formì„ ì‚¬ìš©í•´ì„œ ì…ë ¥ì°½ì„ ê·¸ë£¹í™”í•˜ê³ , ì œì¶œ ì‹œ ìë™ìœ¼ë¡œ ì…ë ¥ ë‚´ìš©ì„ ì´ˆê¸°í™”í•  ìˆ˜ ìˆê²Œ í•´!
with st.form("new_bookmark_form", clear_on_submit=True):
    name = st.text_input("âœ¨ ì¥ì†Œ ì´ë¦„", placeholder="ì˜ˆ: ìš°ë¦¬ ì§‘, ë‹¨ê³¨ ì¹´í˜")
    # ìœ„ë„ì™€ ê²½ë„ëŠ” ì†Œìˆ˜ì  ìë¦¿ìˆ˜ë¥¼ ë§ì¶°ì„œ ë³´ê¸° ì¢‹ê²Œ!
    lat = st.number_input("â¬†ï¸ ìœ„ë„", format="%.4f", value=37.5000, help="ì§€ë„ì˜ ì„¸ë¡œì„  ìœ„ì¹˜ (í•œêµ­ì€ ë³´í†µ 33 ~ 38 ì‚¬ì´)")
    lon = st.number_input("â¡ï¸ ê²½ë„", format="%.4f", value=127.0000, help="ì§€ë„ì˜ ê°€ë¡œì„  ìœ„ì¹˜ (í•œêµ­ì€ ë³´í†µ 126 ~ 129 ì‚¬ì´)")
    description = st.text_area("ğŸ“ ê°„ë‹¨í•œ ì„¤ëª… (ì„ íƒ ì‚¬í•­)", placeholder="ì˜ˆ: ë¶„ìœ„ê¸° ì¢‹ê³  ì»¤í”¼ê°€ ë§›ìˆì–´ìš”.")
    
    # í¼ ì œì¶œ ë²„íŠ¼
    add_button = st.form_submit_button("â­ ë¶ë§ˆí¬ ì¶”ê°€!")

    if add_button: # ë²„íŠ¼ì´ ëˆŒë ¸ì„ ë•Œ
        if name and lat is not None and lon is not None: # ì´ë¦„, ìœ„ë„, ê²½ë„ê°€ ëª¨ë‘ ì…ë ¥ë˜ì—ˆëŠ”ì§€ í™•ì¸!
            new_bookmark = {"name": name, "latitude": lat, "longitude": lon, "description": description}
            st.session_state.bookmarks.append(new_bookmark) # ìƒˆ ë¶ë§ˆí¬ë¥¼ ëª©ë¡ì— ì¶”ê°€!
            st.success(f"'{name}'(ì´)ê°€ ì§€ë„ì— ì¶”ê°€ë˜ì—ˆì–´ìš”! ë©‹ì ¸ìš”! ğŸ‘")
        else:
            st.warning("ì¥ì†Œ ì´ë¦„, ìœ„ë„, ê²½ë„ë¥¼ ê¼­ ì…ë ¥í•´ì•¼ í•´ìš”. ğŸ˜…")

st.markdown("---") # êµ¬ë¶„ì„ 

# --- 2. ë‚´ ë¶ë§ˆí¬ ëª©ë¡ (ì‚¬ì´ë“œë°”) ---
# ì‚¬ì´ë“œë°”ì— í˜„ì¬ ì €ì¥ëœ ë¶ë§ˆí¬ ëª©ë¡ì„ ë³´ì—¬ì¤„ ê±°ì•¼.
st.sidebar.header("ğŸ“ ë‚´ ë¶ë§ˆí¬ ëª©ë¡")
if st.session_state.bookmarks: # ë¶ë§ˆí¬ê°€ ìˆì„ ë•Œë§Œ í‘œì‹œ
    for i, 
